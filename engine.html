<!DOCTYPE html>
<!-- this document uses polyglot markup (well formed XHTML5)  -->
<html id="engine" xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>

<meta charset="utf-8" />

<title>jqt · The jqt template engine</title>
<meta name='description' content='jqt orchestrates several shell utilities to transform MarkDown text and YAML or JSON data into a final HTML page.' />
<meta name='keywords' content='jqt, jq, YAML, gpp, preprocessing, template engine' />
<meta name='author' content='Joan Josep Ordinas Rosa' />

<meta name="generator" content="jqt v0.5.0" />
<meta name='dcterms.date' content='2016-08-28T10:27:09Z' />

<link rel="shortcut icon" href="favicon.ico"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="styles.css"/>
    


</head>

<body class="#container">
<header class="#header">
<nav>
<span class="logo"><a href="index.html">❴❴❏❵❵</a><span class="logo__version">v0.5.0</span></span>
<ol class="menu-bar">
<li class='menu-bar__item '>
<a href="index.html">Home</a>
</li>
<li class='menu-bar__item menu-bar__item_current'>
<a href="engine.html">Engine</a>
</li>
<li class='menu-bar__item '>
<a href="structure.html">Structure</a>
</li>
<li class='menu-bar__item '>
<a href="content.html">Content</a>
</li>
<li class='menu-bar__item '>
<a href="data.html">Data</a>
</li>
</ol>
</nav>
</header>
<main class="#body">
<nav class="#panel -side-right toc">
<p class="toc__title">Page contents</p>
  
<ul>
<li><a href="#template-engine">Template engine</a><ul>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#invoking-jqt">Invoking <cite>jqt</cite></a><ul>
<li><a href="#synopsis">Synopsis</a></li>
<li><a href="#options">Options</a></li>
</ul></li>
<li><a href="#preprocessing">Preprocessing</a></li>
</ul></li>
</ul>

</nav>

<article class="$content">
<h1 id="template-engine">Template engine</h1>
<p>As the <a href="https://en.wikipedia.org/wiki/Template_processor">Wikipedia says</a>, <q><i>a template engine is software designed to combine one or more templates with a data model to produce one or more result documents</i></q>. <cite>jqt</cite> fully satisfies this definition.</p>
<h2 id="implementation">Implementation</h2>
<p><cite>jqt</cite> orchestrates several shell utilities to transform <a href="https://daringfireball.net/projects/markdown/">MarkDown</a> text and <a href="http://yaml.org/">YAML</a> or <a href="http://json.org/">JSON</a> data into a final HTML page. The transformation is driven by a template, where HTML is mixed with <a href="https://stedolan.github.io/jq/"><em>jq</em></a> snippets to implement the transformation logic. This diagram shows how document, template and data inputs (on the left) are combined by <cite>jqt</cite> to produce the final HTML output:</p>
<figure style="margin:0; padding:0;clear:both;">
<figcaption style="text-align:center; font-weight: bold;">
jqt workflow
</figcaption>
<pre><code>           jqt        +------+   +-------+  jq script
Template +-----------&gt;|expand|--&gt;|convert|-------------------------------+
                      +------+   +-------+                               |
                                             HTML and CSS                | 
                                             fragments                   v
           MarkDown   +------+   +------+   /--------&gt;+-----+  JSON   +------+ HTML
Document +-----------&gt;|expand|--&gt;|markup|--+          |merge|--------&gt;|render|------&gt; Page
                      +------+   +------+   \--------&gt;+-----+         +------+
                                             YAML      ^   ^
                                             metadata  |   |
           JSON       +------+                         |   |
         +-----------&gt;|expand|-------------------------+   |
    Data   YAML       +------+                             |     CSS  +------+ 
         +-------------------------------------------------+    +----&gt;|expand|------&gt; Style
           YAML snippets         +------+                  |          +------+
         +----------------------&gt;|markup|------------------+
                                 +------+</code></pre>
</figure>
<p>The command <code>jqt</code> is a shell script executed by <code>bash</code>. The external shell commands called by <code>jqt</code> are <code>cat</code>, <code>gpp</code>, <code>jq</code>, <code>mkdir</code>, <code>mkfifo</code>, <code>pandoc</code>, <code>python</code>, <code>rm</code>, <code>sed</code>, <code>sleep</code> and <code>tee</code>.</p>
<p><code>jqt</code> has been tested with <a href="https://www.gnu.org/software/bash/">Bash 4.3</a>, <a href="https://www.gnu.org/software/sed/">GNU sed 4.2</a>, <a href="https://logological.org/gpp">GPP 2.24</a>, <a href="https://stedolan.github.io/jq/">jq 1.5</a> and <a href="http://pandoc.org/">Pandoc 1.13</a>. A small Python snippet is used which depends on the modules <code>json</code> (introduced with <a href="https://docs.python.org/2.6/">Python 2.6</a>) and <code>yaml</code> (<a href="http://pyyaml.org/">PyYAML</a> implementation). The project uses <a href="https://www.gnu.org/software/make/">GNU Make</a> on several development activities, but <code>make</code> is not necessary to run <code>jqt</code>.</p>
<h2 id="invoking-jqt">Invoking <cite>jqt</cite></h2>
<h3 id="synopsis">Synopsis</h3>
<p><code>jqt</code> accepts several options and can be called with zero, one or two filename arguments. The usage possibilities are:</p>
<p><strong>jqt</strong> [<strong>-h</strong> | <strong>--help</strong> | <strong>-p</strong> | <strong>-V</strong> | <strong>--version</strong>]<br /><strong>jqt</strong> [<em>options</em>] &lt; <em>infile</em> &gt; <em>result</em><br /><strong>jqt</strong> [<em>options</em>] <em>infile</em> &gt; <em>result</em><br /><strong>jqt</strong> [<em>options</em>] <em>infile</em> <em>result</em></p>
<h3 id="options">Options</h3>
<dl>
<dt>-4, -5</dt>
<dd>Sets the output HTML version (HTML4 / HTML5).
</dd>
<dt>-C</dt>
<dd>Stops processing before the render stage and outputs the full JSON data model.
</dd>
<dt>-D NAME=VAL</dt>
<dd>Defines the user macro <em>NAME</em> as equal to <em>VAL</em>.
</dd>
<dt>-d FILE</dt>
<dd>Reads the content document from <em>FILE</em>.
</dd>
<dt>-e</dt>
<dd>Extracts and outputs the MarkDown document YAML front matter.
</dd>
<dt>-H</dt>
<dd>Stops MarkDown processing after generating HTML (outputs several HTML fragments).
</dd>
<dt>-h, --help</dt>
<dd>Displays this message.
</dd>
<dt>-I DIRECTORY</dt>
<dd>Appends <em>DIRECTORY</em> to the end of the preprocessor list of directories to be searched for include files.
</dd>
<dt>-i MODULE</dt>
<dd>Includes the jq <em>MODULE</em> in the render stage.
</dd>
<dt>-j MODULE:NAME</dt>
<dd>Imports the jq <em>MODULE</em> in the render stage.
</dd>
<dt>-L DIRECTORY</dt>
<dd>Appends <em>DIRECTORY</em> to the end of the jq list of directories to be searched for included and imported modules.
</dd>
<dt>-M NAME:FILE</dt>
<dd>Adds a <em>FILE</em> in YAML or JSON format to the input data at the top level (<em>NAME</em> is ignored but must be present and unique).
</dd>
<dt>-m NAME:FILE</dt>
<dd>Adds a <em>FILE</em> in YAML or JSON format to the input data as the value of object <em>NAME</em>.
</dd>
<dt>-n NAME</dt>
<dd>Defines the name for YAML document metadata in <em>jq</em> scripts (defaults to <code>page</code>).
</dd>
<dt>-P LANGUAGE</dt>
<dd>Expands input file with the macro-processor (<em>LANGUAGE</em> can be <code>jqt</code>, <code>md</code>, <code>json</code>, <code>css</code> or <code>css-min</code>).
</dd>
<dt>-p</dt>
<dd>Prints list of Pandoc accepted options.
</dd>
<dt>-r</dt>
<dd>Removes the MarkDown document YAML front matter and outputs the document body.
</dd>
<dt>-S</dt>
<dd>Stops template processing before the render stage (outputs the jq script).
</dd>
<dt>-T [NAME:FILE]</dt>
<dd>Transforms front matter YAML top level MarkDown scalar values to HTML. If <em>NAME:FILE</em> is provided add the transformed data to the input data as a value of object <em>NAME</em>. Otherwise, outputs a new YAML document.
</dd>
<dt>-t</dt>
<dd>Tests presence of front matter in MarkDown (indicated in the output status).
</dd>
<dt>-V, --version</dt>
<dd>Displays version information.
</dd>
<dt>-w</dt>
<dd>Build the data model without input document, only from JSON and YAML input files.
</dd>
</dl>
<h2 id="preprocessing">Preprocessing</h2>
<p>One distinctive feature of <cite>jqt</cite> is the text expansion, using <a href="https://logological.org/gpp">GPP</a>, applied to almost all kinds of input files. Also, <cite>jqt</cite> can be used as a standalone preprocessor thanks to the <code>-P</code> option.</p>
<p><cite>jqt</cite> uses two different syntaxes for macros, one for <a href="./structure.html#preprocessing"><cite>jqt</cite> templates</a> and <a href="./content.html#preprocessing">MarkDown documents</a> and another for <a href="./data.html#preprocessing">JSON and CSS</a> files. The following table summarizes the syntax of macro calls:</p>
<table>
<caption><strong>Summary of macro syntax</strong></caption>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;">JQT and MarkDown</th>
<th style="text-align: left;">JSON and CSS</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Macro calls</td>
<td style="text-align: left;"><code>&lt;%m&gt;</code></td>
<td style="text-align: left;"><code>&amp;m</code></td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>&lt;%m x y&gt;</code></td>
<td style="text-align: left;"><code>&amp;m{x}{y}</code></td>
</tr>
<tr>
<td style="text-align: left;">Macro parameters</td>
<td style="text-align: left;"><code>$1</code>...<code>$9</code></td>
<td style="text-align: left;"><code>$1</code>...<code>$9</code></td>
</tr>
<tr>
<td style="text-align: left;">Interpolation in arguments</td>
<td style="text-align: left;"><code>&quot; &quot;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Escape in arguments</td>
<td style="text-align: left;"><code>' '</code></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the syntax of text skips:</p>
<table>
<caption><strong>Summary of text skips</strong></caption>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;">JQT templates</th>
<th style="text-align: left;">MarkDown content</th>
<th style="text-align: left;">JSON documents</th>
<th style="text-align: left;">CSS stylesheets</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Continuation lines</td>
<td style="text-align: left;"><code>&amp;</code></td>
<td style="text-align: left;"><code>&amp;</code></td>
<td style="text-align: left;"><code>&amp;</code></td>
<td style="text-align: left;"><code>&amp;</code></td>
</tr>
<tr>
<td style="text-align: left;">Block comment</td>
<td style="text-align: left;"><code>&lt;# #&gt;</code></td>
<td style="text-align: left;"><code>&lt;# #&gt;</code></td>
<td style="text-align: left;"><code>/* */</code></td>
<td style="text-align: left;"><code>/* */</code></td>
</tr>
<tr>
<td style="text-align: left;">Line comment</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>//</code></td>
<td style="text-align: left;"><code>//</code></td>
</tr>
<tr>
<td style="text-align: left;">Bypass<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></td>
<td style="text-align: left;"><code>&lt;!-- --&gt;</code></td>
<td style="text-align: left;"><code>&lt;!-- --&gt;</code></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>` `</code></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>\n~~~</code> (also backticks)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Escape<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>` `</code></td>
<td style="text-align: left;"><code>` `</code></td>
</tr>
<tr>
<td style="text-align: left;">String<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a></td>
<td style="text-align: left;"><code>{% %}</code></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>&quot; &quot;</code></td>
<td style="text-align: left;"><code>&quot; &quot;</code></td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>{{ }}</code></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>' '</code></td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;"><code>{# #}</code></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Text copied verbatim.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Quotes removed, text no expanded.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Quotes not removed, text expanded.<a href="#fnref3">↩</a></p></li>
</ol>
</section>

</article>

</main>

<footer class="#footer">
<section class="license">
<p><small>This website is made with <a href="https://fadado.github.io/jqt/"><em>jqt</em></a>.<br /><em>jqt</em> is licensed under the <a href="https://github.com/fadado/jqt/blob/master/LICENSE">MIT</a> license (code) and the <a href="https://creativecommons.org/licenses/by/3.0/">CC-BY-3.0</a> license (documents).</small></p>

</section>
<ol class="repository">
<li class="repository__section"><a href="https://github.com/fadado/jqt">code</a></li>
<li class="repository__section"><a href="https://github.com/fadado/jqt/issues">issues</a></li>
<li class="repository__section"><a href="https://github.com/fadado/jqt/wiki">wiki</a></li>
<li class="repository__section"><a href="https://github.com/fadado/jqt/releases">releases</a></li>
</ol>
</footer>
<script type="text/javascript">/*<![CDATA[*/
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-82432866-1', 'auto');
  ga('send', 'pageview');
/*]]>*/</script>
</body>
</html>


