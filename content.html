<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="content-content" xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>jqt · Authoring content &ndash; jqt, the jq template engine</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="jqt v0.3.0"/>
<meta name='author' content='Joan Josep Ordinas Rosa' />
<meta name='dcterms.modified' content='2016-08-28T10:27:09Z' />
<link rel="stylesheet" type="text/css" href="styles.css"/>

<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>


</head>

<body class="#container">
<div class="#header">
<span class="logo"><a href="index.html">❴❴❏❵❵</a><span class="logo::version">v0.3.0</span></span>


<ol class="menu-bar">
<li class='menu-bar::item '>
<a href="./engine.html">Engine</a>
</li>
<li class='menu-bar::item '>
<a href="./structure.html">Structure</a>
</li>
<li class='menu-bar::item menu-bar::item!active'>
<a href="./content.html">Content</a>
</li>
<li class='menu-bar::item '>
<a href="./data.html">Data</a>
</li>
</ol>

</div>

<div class="#body">
<h1><cite>jqt</cite> · Authoring content</h1>
<div class="#panel #panel!side-right toc">
<p class="toc::title">Page contents</p>
  
<ul>
<li><a href="#general-operation">General operation</a></li>
<li><a href="#file-structure">File structure</a><ul>
<li><a href="#front-matter">Front matter</a></li>
<li><a href="#body">Body</a></li>
<li><a href="#markdown-snippets">MarkDown snippets</a></li>
</ul></li>
<li><a href="#document-syntax">Document syntax</a><ul>
<li><a href="#preprocessing">Preprocessing</a><ul>
<li><a href="#macro-calls">Macro calls</a></li>
<li><a href="#skips">Skips</a></li>
</ul></li>
<li><a href="#pandocs-markdown">Pandoc’s Markdown</a></li>
</ul></li>
</ul>

</div>


<div class="#content">
<h2 id="general-operation">General operation</h2>
<p><em>jqt</em> transforms <a href="https://daringfireball.net/projects/markdown/">MarkDown</a> documents to HTML using Pandoc, but before that <a href="https://logological.org/gpp">GPP</a> is used to preprocess them. Pandoc's output is then merged with the <a href="http://yaml.org/">YAML</a> front matter metadata and other input data before be sended to the render stage. This is described on the middle of this diagram:</p>
<div id="flowhack" class="clearfix">

</div>
<pre><code>           jqt        +------+   +-------+  jq script
Template +-----------&gt;|expand|--&gt;|convert|-------------------------------+
                      +------+   +-------+                               |
                                             HTML and CSS                | 
                                             fragments                   v
           MarkDown   +------+   +------+   /--------&gt;+-----+  JSON   +------+ HTML
Document +-----------&gt;|expand|--&gt;|markup|--+          |merge|--------&gt;|render|------&gt; Page
                      +------+   +------+   \--------&gt;+-----+         +------+
                                             YAML      ^   ^
                                             metadata  |   |
           JSON       +------+                         |   |
         +-----------&gt;|expand|-------------------------+   |
    Data   YAML       +------+                             |
         +-------------------------------------------------+
           YAML snippets         +------+                  |
         +----------------------&gt;|markup|------------------+
                                 +------+</code></pre>
<p>When invoking <code>jqt</code> you can use the following options to influence document conversion:</p>
<dl>
<dt>-4, -5</dt>
<dd>Sets the output HTML version (HTML4 / HTML5).
</dd>
<dt>-D NAME=VAL</dt>
<dd>Defines the user macro <em>NAME</em> as equal to <em>VAL</em>.
</dd>
<dt>-d FILE</dt>
<dd>Reads the content document from <em>FILE</em>.
</dd>
<dt>-I DIRECTORY</dt>
<dd>Appends <em>DIRECTORY</em> to the end of the preprocessor list of directories to be searched for include files.
</dd>
</dl>
<h2 id="file-structure">File structure</h2>
<p>Document files contain MarkDown text preceded by an optional YAML front matter.</p>
<h3 id="front-matter">Front matter</h3>
<p><em>jqt</em> extracts the YAML front matter, located at the very beginning of the file, and injcontent. ects it into the render stage under a global JSON object named <code>.page</code>.</p>
<h3 id="body">Body</h3>
<p>Pandoc converts the document body to HTML, and <em>jqt</em> injects it into the render stage under the global JSON scalar <code>.page._content</code>. If the document contains fenced code blocks specifying the language of the code block, the related highlight CSS code will be in the scalar <code>.page._highlight</code>. Also, the HTML table of contents is available in the scalar <code>.page._toc</code>, and the path to the document file in the scalar <code>.page._path</code>.</p>
<h3 id="markdown-snippets">MarkDown snippets</h3>
<p><code>jqt</code> <code>-T</code> option allows the use of YAML files for collections of MarkDown snippets:</p>
<dl>
<dt>-T [NAME:FILE]</dt>
<dd>Transforms front matter YAML top level MarkDown scalar values to HTML. If <em>NAME:FILE</em> is provided add the transformed data to the input data as a value of object <em>NAME</em>. Otherwise, outputs a new YAML document.
</dd>
</dl>
<p>This feature can be used to collect multiple text snippets in only one file. The MarkDown can be transformed to HTML and put in a new YAML or JSON file with a command like this:</p>
<pre class="sourceCode zsh"><code class="sourceCode zsh">jqt -T -- text.yaml <span class="kw">|</span> yaml2json <span class="kw">&gt;</span> snippets.json</code></pre>
<p>Then this converted file can be loaded by <code>jqt</code> in succesive calls:</p>
<pre class="sourceCode zsh"><code class="sourceCode zsh">jqt -m snippets:snippets.json ...</code></pre>
<p>Template files can expand the snippets without never containing raw content:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;h1&gt;</span>{{.snippets.title}}<span class="kw">&lt;/h1&gt;</span></code></pre>
<p>This allows the absolute separation of structure and content, as it should be.</p>
<h2 id="document-syntax">Document syntax</h2>
<p>Document's conversion has two stages. In the first the text is preprocessed, and the second does the proper conversion to HTML.</p>
<h3 id="preprocessing">Preprocessing</h3>
<p>The MarkDown input content is preprocessed using <a href="https://logological.org/gpp">GPP</a>. All the expected options in a preprocessor are available, like defining new macros, include other files, etc. For example, a macro call like <code>&lt;%include &quot;../VERSION&quot;&gt;</code> will expand to he string <code>0.3.0</code> as you can see in this paragraph and on the top of these pages.</p>
<h4 id="macro-calls">Macro calls</h4>
<p>All the power of GPP is available to help you when <a href="https://en.wikipedia.org/wiki/Wikipedia:Transclusion">transcluding</a> the input MarkDown document. The macro syntax used by <em>jqt</em> in input documents precedes macro names with the characters <code>&lt;%</code> and finishes the macro calls with the character <code>&gt;</code>. The more common predefined macros have this syntax:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="er">&lt;</span>%defeval x y&gt;
<span class="er">&lt;</span>%define x y&gt;
<span class="er">&lt;</span>%elif expr&gt;
<span class="er">&lt;</span>%else&gt;
<span class="er">&lt;</span>%endif&gt;
<span class="er">&lt;</span>%eval expr&gt;
<span class="er">&lt;</span>%if expr&gt;
<span class="er">&lt;</span>%ifdef x&gt;
<span class="er">&lt;</span>%ifeq x y&gt;
<span class="er">&lt;</span>%ifndef x&gt;
<span class="er">&lt;</span>%ifneq x y&gt;
<span class="er">&lt;</span>%include file&gt;
<span class="er">&lt;</span>%undef x&gt;</code></pre>
<p>Inside macro definitions argument references are prefixed by a dollar (<code>$1</code>, <code>$2</code>, etc.), but named arguments are also possible:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="er">&lt;</span>%define sc
<span class="kw">&lt;span</span><span class="ot"> style=</span><span class="st">&quot;font-variant:small-caps;&quot;</span><span class="kw">&gt;</span>$1<span class="kw">&lt;/span&gt;</span>
&gt;</code></pre>
<p>Predefined macros and user define macros have the same call sequence:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="er">&lt;</span>%include content/LINKS.txt&gt;
<span class="er">&lt;</span>%sc &#39;A title in small caps&#39;&gt;</code></pre>
<p>Warning: you must read the <a href="https://files.nothingisreal.com/software/gpp/gpp.html">GPP manual</a> if you want to know all the gory details.</p>
<h4 id="skips">Skips</h4>
<p>Some fragments of text are skipped during macro expansion, like comments, continuation lines and arbitrary but delimited strings of characters:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="er">&lt;</span># Block comments, removed, must end in newline (also removed) #&gt;
Continuation lines using an ampersand <span class="er">&amp;</span>
just before the newline character</code></pre>
<p><em>Strings</em> are copied to the output, but evaluation of macros inside strings can be enabled or disabled. String delimiters can be copied, or not, to the output:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- XML comments --&gt;</span>
<span class="er">&lt;</span>%sc &#39;Single quoted strings, only available in user defined macro calls&#39;&gt;
<span class="er">&lt;</span>%sc &quot;Double quoted strings, only available in user defined macro calls&#39;&gt;
Inline code `inside backticks`
```
Fenced code blocks with tildes (~~~) or backticks (```)
```</code></pre>
<p>This table summarizes all the available document skips:</p>
<table>
<caption><strong>Semantics for all MarkDown document skips</strong></caption>
<thead>
<tr class="header">
<th align="center">Delimiters</th>
<th align="left">Macro expansion</th>
<th align="left">Delimiters removed</th>
<th align="left">Content removed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>&amp;\n</code><a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></td>
<td align="left">No</td>
<td align="left">Yes</td>
<td align="left">There is no content</td>
</tr>
<tr class="even">
<td align="center"><code>&lt;#</code> <code>#&gt;\n</code></td>
<td align="left">No</td>
<td align="left">Yes</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="center"><code>'</code> <code>'</code><a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></td>
<td align="left">No</td>
<td align="left">Yes</td>
<td align="left">No</td>
</tr>
<tr class="even">
<td align="center"><code>&quot;</code> <code>&quot;</code><a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a></td>
<td align="left">Yes</td>
<td align="left">Yes</td>
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="center"><code>&lt;!--</code> <code>--&gt;</code></td>
<td align="left">No</td>
<td align="left">No</td>
<td align="left">No</td>
</tr>
<tr class="even">
<td align="center"><code>`</code> <code>`</code></td>
<td align="left">No</td>
<td align="left">No</td>
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="center"><code>\n```</code><a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a></td>
<td align="left">No</td>
<td align="left">No</td>
<td align="left">No</td>
</tr>
<tr class="even">
<td align="center"><code>\n~~~</code><a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a></td>
<td align="left">No</td>
<td align="left">No</td>
<td align="left">No</td>
</tr>
</tbody>
</table>
<h3 id="pandocs-markdown">Pandoc’s Markdown</h3>
<p><em>jqt</em> accept as input format the <a href="http://pandoc.org/MANUAL.html#pandocs-markdown">Pandoc's MarkDown</a> variant, with the <a href="http://pandoc.org/MANUAL.html#extension-pandoc_title_block">title block extension</a> disabled, and produces transitional HTML. When running <code>jqt</code> the following Pandoc long options can be specified in the command line and will be forwarded untouched to <code>pandoc</code>:</p>
<pre><code>    --base-header-level=NUMBER                        --latexmathml[=URL]
    --bibliography=FILE                               --mathjax[=URL]
    --citation-abbreviations=FILE                     --mathml[=URL]
    --columns=NUMBER                                  --mimetex[=URL]
    --csl=FILE                                        --no-highlight
    --email-obfuscation=none|javascript|references    --normalize
    --file-scope                                      --number-offset=NUMBER[,NUMBER,...]
    --gladtex                                         --number-sections
    --highlight-style=STYLE                           --preserve-tabs
    --html-q-tags                                     --section-divs
    --id-prefix=STRING                                --tab-stop=NUMBER
    --indented-code-classes=CLASSES                   --toc-depth=NUMBER
    --jsmath[=URL]                                    --webtex[=URL]
    --katex[=URL]                                     --wrap=[auto|none|preserve]
    --katex-stylesheet</code></pre>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>An ampersand followed by a newline is treated as a line continuation (that is, the ampersand and the newline are removed and effectively ignored).<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Only inside user defined macros.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Only inside user defined macros.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>Blocks of code fenced between two lines with three or more backticks.<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>Blocks of code fenced between two lines with three or more tildes.<a href="#fnref5">↩</a></p></li>
</ol>
</div>

</div>

</div>

<div class="#footer">
<div class="license">
<p>This website is made with <a href="https://fadado.github.io/jqt/"><em>jqt</em></a>.<br /><em>jqt</em> is licensed under the MIT license (code) and the <a href="https://creativecommons.org/licenses/by/3.0/">CC-BY-3.0</a> license (documents).</p>

</div>

<ol class="repository">
<li class="repository::section"><a href="https://github.com/fadado/jqt">code</a></li>
<li class="repository::section"><a href="https://github.com/fadado/jqt/issues">issues</a></li>
<li class="repository::section"><a href="https://github.com/fadado/jqt/wiki">wiki</a></li>
<li class="repository::section"><a href="https://github.com/fadado/jqt/releases">releases</a></li>
</ol>


</div>

<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-82432866-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>


