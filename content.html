<!DOCTYPE html>
<!-- this document uses polyglot markup (well formed XHTML5)  -->
<html id="content" xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>

<meta charset="utf-8" />

<title>jqt · Authoring content in jqt using MarkDown</title>
<meta name='description' content='jqt transforms MarkDown documents to HTML using Pandoc.' />
<meta name='keywords' content='jqt, markdown, pandoc, gpp, preprocessing, authoring content' />
<meta name='author' content='Joan Josep Ordinas Rosa' />

<meta name="generator" content="JQT v0.5.1" />
<meta name='dcterms.date' content='2016-08-28T10:27:09Z' />

<link rel="shortcut icon" href="favicon.ico"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="styles.css"/>
    
<style type="text/css">/*<![CDATA[*/
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
/*]]>*/</style>


</head>

<body class="#container">
<header class="#header">
<nav>
<span class="logo"><a title="jqt, the jq template engine" href="index.html">❴❴❏❵❵</a><span class="logo__version">v0.5.1</span></span>
<ol class="menu-bar">
<li class='menu-bar__item '>
<a href="index.html">Home</a>
</li>
<li class='menu-bar__item '>
<a href="engine.html">Engine</a>
</li>
<li class='menu-bar__item '>
<a href="structure.html">Structure</a>
</li>
<li class='menu-bar__item menu-bar__item_current'>
<a href="content.html">Content</a>
</li>
<li class='menu-bar__item '>
<a href="data.html">Data</a>
</li>
</ol>
</nav>
</header>
<main class="#body">
<nav class="#panel -side-right toc">
<p class="toc__title">Page contents</p>
  
<ul>
<li><a href="#authoring-content">Authoring content</a><ul>
<li><a href="#general-operation">General operation</a></li>
<li><a href="#file-structure">File structure</a><ul>
<li><a href="#front-matter">Front matter</a></li>
<li><a href="#body">Body</a></li>
<li><a href="#markdown-snippets">MarkDown snippets</a></li>
</ul></li>
<li><a href="#document-syntax">Document syntax</a><ul>
<li><a href="#preprocessing">Preprocessing</a><ul>
<li><a href="#macro-calls">Macro calls</a></li>
<li><a href="#skips">Skips</a></li>
</ul></li>
<li><a href="#pandocs-markdown">Pandoc’s Markdown</a></li>
</ul></li>
</ul></li>
</ul>

</nav>

<article class="$content">
<h1 id="authoring-content">Authoring content</h1>
<p>Authors must be freed from any concern regarding the presentation of his writings, and his dedication to its structure must be the essential minimum: <em>MarkDown</em> promises and delivers exactly this.</p>
<h2 id="general-operation">General operation</h2>
<p><cite>jqt</cite> transforms <a href="https://daringfireball.net/projects/markdown/">MarkDown</a> documents to HTML using <a href="http://pandoc.org/">Pandoc</a>, but before that <a href="https://logological.org/gpp">GPP</a> is used to preprocess them. Pandoc’s output is packaged as JSON data and then merged with the <a href="http://yaml.org/">YAML</a> front matter metadata and other input data before be sended to the render stage. This is described on the middle of this diagram:</p>
<figure style="margin:0; padding:0;clear:both;">
<figcaption style="text-align:center; font-weight: bold;">
jqt workflow
</figcaption>
<pre><code>           jqt        +------+   +-------+  jq script
Template +-----------&gt;|expand|--&gt;|convert|-------------------------------+
                      +------+   +-------+                               |
                                             HTML and CSS                | 
                                             fragments                   v
           MarkDown   +------+   +------+   /--------&gt;+-----+  JSON   +------+ HTML
Document +-----------&gt;|expand|--&gt;|markup|--+          |merge|--------&gt;|render|------&gt; Page
                      +------+   +------+   \--------&gt;+-----+         +------+
                                             YAML      ^   ^
                                             metadata  |   |
           JSON       +------+                         |   |
         +-----------&gt;|expand|-------------------------+   |
    Data   YAML       +------+                             |     CSS  +------+ 
         +-------------------------------------------------+    +----&gt;|expand|------&gt; Style
           YAML snippets         +------+                  |          +------+
         +----------------------&gt;|markup|------------------+
                                 +------+</code></pre>
</figure>
<details>
<summary> When invoking <code>jqt</code> you can use the <code>-4</code>, <code>-5</code>, <code>-D</code>, <code>-d</code>, and <code>-I</code> options to influence document conversion: </summary>
<dl>
<dt>-4, -5</dt>
<dd>Sets the output HTML version (HTML4 / HTML5).
</dd>
<dt>-D NAME=STRING</dt>
<dd>Defines the user macro <em>NAME</em> as equal to <em>STRING</em>.
</dd>
<dt>-d FILE</dt>
<dd>Reads the content document from <em>FILE</em>.
</dd>
<dt>-I DIRECTORY</dt>
<dd>Appends <em>DIRECTORY</em> to the end of the preprocessor list of directories to be searched for include files.
</dd>
</dl>
</details>
<h2 id="file-structure">File structure</h2>
<p>Document files contain MarkDown text preceded by an optional YAML front matter.</p>
<h3 id="front-matter">Front matter</h3>
<p><cite>jqt</cite> extracts the YAML front matter, located at the very beginning of the file, and injects it into the render stage under a global JSON object named <code>._front_matter</code>.</p>
<h3 id="body">Body</h3>
<p>Pandoc translates the document body to HTML, and <cite>jqt</cite> injects it into the render stage under the global JSON scalar <code>._content</code>. If the document contains fenced code blocks specifying the language of the code block, the related highlight CSS code will be in the scalar <code>._highlight</code>. Also, the HTML table of contents is available in the scalar <code>._toc</code>, and the path to the document file in the scalar <code>._source</code>.</p>
<h3 id="markdown-snippets">MarkDown snippets</h3>
<details>
<summary> <cite>jqt</cite> offers also a transformation that can also be considered a kind of preprocessing. The option <code>-T</code> allows the use of YAML files for collections of MarkDown snippets: </summary>
<dl>
<dt>-T [NAME:FILE]</dt>
<dd>Transforms front matter YAML top level MarkDown scalar values to HTML. If <em>NAME:FILE</em> is provided add the transformed data to the input data as a value of object <em>NAME</em>. Otherwise, outputs a new YAML document.
</dd>
</dl>
</details>
<p>This feature can be used to collect multiple text snippets in only one file (YAML file or MarkDown file with only front-matter). The MarkDown can be transformed to HTML and put in a new YAML or JSON file with a command like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb2-1"><a href="#cb2-1"></a>jqt -T -- text.yaml <span class="kw">|</span> yaml2json <span class="kw">&gt;</span> snippets.json</span></code></pre></div>
<p>Then this converted file can be loaded by <code>jqt</code> in succesive calls:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb3-1"><a href="#cb3-1"></a>jqt -j snippets:snippets.json ...</span></code></pre></div>
<p>Template files (only!) can expand the snippets without never containing raw content:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">&lt;h1&gt;</span>{{snippets.title}}<span class="kw">&lt;/h1&gt;</span></span></code></pre></div>
<p>This allows the absolute separation of structure and content, as it should be.</p>
<h2 id="document-syntax">Document syntax</h2>
<p>Document’s conversion has two stages. In the first the text is preprocessed, and the second does the proper conversion to HTML.</p>
<h3 id="preprocessing">Preprocessing</h3>
<p>The MarkDown input content is preprocessed using <a href="https://logological.org/gpp">GPP</a>. All the expected options in a preprocessor are available, like defining new macros, include other files, etc. For example, a macro call like <code>&lt;%version&gt;</code> will expand to the <cite>jqt</cite> version (<code>0.5.1</code>) as you can see in this paragraph.</p>
<h4 id="macro-calls">Macro calls</h4>
<p>All the power of <a href="https://logological.org/gpp">GPP</a> is available to help you when <a href="https://en.wikipedia.org/wiki/Wikipedia:Transclusion">transcluding</a> the input MarkDown document. The macro syntax used by <cite>jqt</cite> in templates and input documents precedes macro names with the characters <code>&lt;%</code> and finishes the macro calls with the character <code>&gt;</code>. Here are some of the predefined macros:</p>
<pre><code>&lt;%defeval x y&gt;
&lt;%define x y&gt;
&lt;%elif expr&gt;
&lt;%else&gt;
&lt;%endif&gt;
&lt;%eval expr&gt;
&lt;%if expr&gt;
&lt;%ifdef x&gt;
&lt;%ifeq x y&gt;
&lt;%ifndef x&gt;
&lt;%ifneq x y&gt;
&lt;%include file&gt;
&lt;%undef x&gt;</code></pre>
<p>Inside macro definitions parameters are prefixed by a dollar (<code>$1</code>, <code>$2</code>, etc.), but named parameters are also possible:</p>
<pre><code>&lt;%define sc
    &lt;span style=&quot;font-variant:small-caps;&quot;&gt;$1&lt;/span&gt;
&gt;</code></pre>
<p>Predefined macros and user define macros have the same call sequence:</p>
<pre><code>&lt;%include content/LINKS.txt&gt;
&lt;%sc &#39;A title in small caps&#39;&gt;</code></pre>
<p>Warning: you must see the <a href="https://files.nothingisreal.com/software/gpp/gpp.html">GPP manual</a> if you want to know all the gory details.</p>
<h4 id="skips">Skips</h4>
<p>Some fragments of text are skipped during macro expansion, like comments, continuation lines and arbitrary but delimited strings of characters:</p>
<pre><code>&lt;# Block comments, removed #&gt;
Continuation lines using an ampersand &amp;
just before the newline character</code></pre>
<p><em>Strings</em> are copied to the output, but evaluation of macros inside strings can be enabled or disabled depending on the type of string. Also, string delimiters can be copied, or not, to the output:</p>
<pre><code>&lt;!-- XML comments --&gt;
&lt;%sc &#39;Single quoted strings, only available in user defined macro calls&#39;&gt;
&lt;%sc &quot;Double quoted strings, only available in user defined macro calls&quot;&gt;
Inline code `inside backticks`
```
Fenced code blocks with tildes (~~~) or backticks (```)
```</code></pre>
<p>This table summarizes all the available skips:</p>
<table>
<caption><strong>Semantics for all MarkDown document skips</strong></caption>
<thead>
<tr>
<th style="text-align: center;">Delimiters</th>
<th>Macro expansion</th>
<th>Delimiters removed</th>
<th>Content removed</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>&amp;\n</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></td>
<td>No</td>
<td>Yes</td>
<td>There is no content</td>
</tr>
<tr>
<td style="text-align: center;"><code>&lt;#</code> <code>#&gt;</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td style="text-align: center;"><code>'</code> <code>'</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></td>
<td>No</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td style="text-align: center;"><code>"</code> <code>"</code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td style="text-align: center;"><code>&lt;!--</code> <code>--&gt;</code></td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td style="text-align: center;"><code>`</code> <code>`</code></td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td style="text-align: center;"><code>\n```</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td style="text-align: center;"><code>\n~~~</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
</tbody>
</table>
<h3 id="pandocs-markdown">Pandoc’s Markdown</h3>
<p><cite>jqt</cite> accepts as input format for documents the <a href="http://pandoc.org/MANUAL.html#pandocs-markdown">Pandoc’s MarkDown</a> variant, with the <a href="http://pandoc.org/MANUAL.html#extension-pandoc_title_block">title block extension</a> disabled, and produces by default transitional HTML. When running <code>jqt</code> all long options specified in the command line will be forwarded untouched to <code>pandoc</code> (as for example with <code>--help</code>), but some are reserved or have no meaning.</p>
<p><cite>Pandoc</cite> options used internally by <cite>jqt</cite> (do not play with them):</p>
<pre><code>    --from=FORMAT
    --to=FORMAT
    --template=FILE
    --table-of-contents
    --output=FILE</code></pre>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>An ampersand followed by a newline is treated as a line continuation (that is, the ampersand and the newline are removed and effectively ignored).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Only inside user defined macros.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>Only inside user defined macros.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>Blocks of code fenced between two lines with three or more backticks.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>Blocks of code fenced between two lines with three or more tildes.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</article>

</main>

<footer class="#footer">
<section class="license">
<p><small>This website is made with <a href="https://fadado.github.io/jqt/"><em>jqt</em></a>.<br /> <em>jqt</em> is licensed under the <a href="https://github.com/fadado/jqt/blob/master/LICENSE">MIT</a> license (code) and the <a href="https://creativecommons.org/licenses/by/3.0/">CC-BY-3.0</a> license (documents).</small></p>

</section>
<ol class="repository">
<li class="repository__section"><a href="https://github.com/fadado/jqt">code</a></li>
<li class="repository__section"><a href="https://github.com/fadado/jqt/issues">issues</a></li>
<li class="repository__section"><a href="https://github.com/fadado/jqt/wiki">wiki</a></li>
<li class="repository__section"><a href="https://github.com/fadado/jqt/releases">releases</a></li>
<li class="repository__section"><a href="#">top</a></li>
</ol>
</footer>
<script type="text/javascript">/*<![CDATA[*/
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-82432866-1', 'auto');
  ga('send', 'pageview');
/*]]>*/</script>
</body>
</html>


